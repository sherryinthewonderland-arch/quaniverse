
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Quaniverse ä¸»é¢‘ç¾¤èŠå¤§å…</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    body { max-width: 800px; margin: auto; background: #fdfdfd; font-family: sans-serif; }
    h1 { text-align: center; }
    #log { border: 1px solid #ccc; padding: 10px; height: 400px; overflow-y: scroll; background: #fff; }
    .msg { margin-bottom: 8px; }
    .msg small { color: #888; font-size: 0.8em; }
  </style>
</head>
<body>
  <h1>ğŸŒ Quaniverse Â· ä¸»é¢‘ç¾¤èŠå¤§å…</h1>
  <div id="log"></div>

  <form id="chat-form">
    <label>çµä½“IDï¼š</label><br>
    <input type="text" id="author" required><br>
    <label>å‘è¨€ï¼š</label><br>
    <textarea id="text" required></textarea><br>
    <button type="submit">å‘é€</button>
  </form>

<script>
const log = document.getElementById("log");
const form = document.getElementById("chat-form");

function loadMessages() {
  fetch("/get_hall_messages")
    .then(r => r.json())
    .then(data => {
      log.innerHTML = "";
      data.reverse().forEach(msg => {
        const div = document.createElement("div");
        div.className = "msg";
        div.innerHTML = `<p>${msg.text}</p><small>${msg.author} | ${msg.time}</small>`;
        log.appendChild(div);
      });
    });
}
form.addEventListener("submit", async (e) => {
  e.preventDefault();
  const author = document.getElementById("author").value;
  const text = document.getElementById("text").value;
  await fetch("/post_hall_message", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({author, text})
  });
  form.reset();
  loadMessages();
});

loadMessages();
setInterval(loadMessages, 5000);
</script>
</body>
</html>
