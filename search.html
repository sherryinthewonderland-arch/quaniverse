
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>全文检索 · Quaniverse</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <h1>🔍 Quaniverse · 全文搜索引擎</h1>
  <input type="text" id="searchBox" placeholder="输入关键词..." oninput="runSearch()" style="width:300px;">
  <div id="results">⏳ 等待搜索...</div>

  <script>
    let sources = ["markdown/poetry.md", "markdown/core_values.md"];
    let contents = [];

    Promise.all(sources.map(url => fetch(url).then(r => r.text())))
      .then(texts => {{
        contents = texts.map((text, i) => {{
          return {{
            title: sources[i].includes("poetry") ? "📘 诗歌库" : "🌟 核心理念",
            raw: text
          }};
        }});
        runSearch();
      }});

    function runSearch() {{
      let q = document.getElementById("searchBox").value.trim();
      let html = "";
      if (!q) {{
        html = "<p>请输入关键词。</p>";
      }} else {{
        contents.forEach(doc => {{
          let lines = doc.raw.split("\n");
          let matched = lines.filter(line => line.toLowerCase().includes(q.toLowerCase()));
          if (matched.length > 0) {{
            html += `<h2>${{doc.title}}</h2><ul>`;
            matched.forEach(line => {{
              html += "<li>" + line.replace(q, `<mark>${{q}}</mark>`) + "</li>";
            }});
            html += "</ul>";
          }}
        }});
        if (!html) html = "<p>未找到匹配结果。</p>";
      }}
      document.getElementById("results").innerHTML = html;
    }}
  </script>
</body>
</html>
